<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>elastic stack on @johtaniの日記 3rd</title>
    <link>https://blog.johtani.info/tags/elastic-stack/</link>
    <description>Recent content in elastic stack on @johtaniの日記 3rd</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja</language>
    <lastBuildDate>Fri, 15 May 2020 11:17:17 +0900</lastBuildDate><atom:link href="https://blog.johtani.info/tags/elastic-stack/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Elastic Stack 7.7がリリースされた</title>
      <link>https://blog.johtani.info/blog/2020/05/15/elastic-stack-7_7/</link>
      <pubDate>Fri, 15 May 2020 11:17:17 +0900</pubDate>
      
      <guid>https://blog.johtani.info/blog/2020/05/15/elastic-stack-7_7/</guid>
      <description>ElasticのWorkplace Searchを触ってみています(その1、その2)が、Elastic Stackの7.7.0がリリースされてし</description>
      <content:encoded><p>ElasticのWorkplace Searchを触ってみています(<a href="https://blog.johtani.info/blog/2020/05/01/intro-workplace-search/">その1</a>、<a href="https://blog.johtani.info/blog/2020/05/07/install-workplace-search/">その2</a>)が、Elastic Stackの7.7.0がリリースされてしまいました。</p>
<p>簡単ですが、リリースブログを見ながら気になった点をメモしとこうかと。</p>
<h2 id="本家のリリースブログ">本家のリリースブログ</h2>
<p>いっぱいあるんですよ、これが。まぁ、内容かぶってるのもあるんですが。</p>
<h3 id="elastic-stack">Elastic Stack</h3>
<ul>
<li><a href="https://www.elastic.co/jp/blog/elastic-stack-7-7-0-released">Elastic Stack 7.7.0をリリース</a></li>
<li><a href="https://www.elastic.co/blog/elasticsearch-7-7-0-released">Elasticsearch 7.7.0 released</a></li>
<li><a href="https://www.elastic.co/blog/kibana-7-7-0-released">Kibana 7.7.0 released</a></li>
<li><a href="https://www.elastic.co/blog/logstash-7-7-0-released">Logstash 7.7.0 released</a></li>
</ul>
<h3 id="enterprise-search系">Enterprise Search系</h3>
<ul>
<li><a href="https://www.elastic.co/blog/elastic-enterprise-search-7-7-0-released">Elastic Enterprise Search 7.7 released, featuring Workplace Search GA | Elastic Blog</a></li>
<li><a href="https://www.elastic.co/blog/elastic-app-search-7-7-0-released">Elastic App Search updates： Scale your way with new configuration options | Elastic Blog</a></li>
<li><a href="https://www.elastic.co/jp/blog/elastic-workplace-search-7-7-0-released">Elastic Workplace Search： 新しい、統合された働き方へ</a></li>
</ul>
<h3 id="observability系">Observability系</h3>
<ul>
<li>
<p><a href="https://www.elastic.co/blog/elastic-observability-7-7-0-released">Elastic Observability 7.7 released | Elastic Blog</a></p>
</li>
<li>
<p><a href="https://www.elastic.co/blog/elastic-apm-7-7-0-released">Elastic APM 7.7.0 released with service maps, async profiler, and more | Elastic Blog</a></p>
</li>
<li>
<p><a href="https://www.elastic.co/blog/elastic-logs-7-7-0-released">Elastic Logs 7.7.0 released with PCF support, MQTT support, and more | Elastic Blog</a></p>
</li>
<li>
<p><a href="https://www.elastic.co/blog/elastic-metrics-7-7-0-released">Elastic Metrics 7.7.0 released with enhanced Prometheus integration and PCF support, | Elastic Blog</a></p>
</li>
<li>
<p><a href="https://www.elastic.co/blog/elastic-uptime-monitoring-7-7-0-released">Elastic Uptime Monitoring 7.7.0 released with alerting, anomaly detection and more | Elastic Blog</a></p>
</li>
<li>
<p><a href="https://www.elastic.co/blog/introducing-the-new-alerting-framework-for-observability-security-and-the-elastic-stack">New alerting framework released for Observability, Security and the Elastic Stack | Elastic Blog</a></p>
</li>
<li>
<p><a href="https://www.elastic.co/blog/elastic-security-7-7-0-released">Introducing Elastic Security 7.7.0 | Elastic Blog</a></p>
</li>
</ul>
<h2 id="個人的に気になったもの">個人的に気になったもの</h2>
<p>で、全部読んだわけではないのですが、個人的に気になった機能についてメモを残しておきます。
多分に検索によっている可能性がありますが、お気になさらず。
また、ブログとドキュメントを元に気になるところをピックアップしてます。
実際の実装とか動作に関してはまだ未調査の段階です。</p>
<h3 id="async-search---elasticsearch">Async Search - Elasticsearch</h3>
<p>ElasticsearchのAPIとして非同期に検索できるAPIが実装されました
(<a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.7/async-search.html">公式リファレンス</a>)。
大量データを検索が終了してから検索結果を返すのではなく、クエリは実行しつつわかったところまでは都度取得したいという要望だったり、Coldインデックスのように遅いストレージ上にあるデータへの検索でも少しずつ取得できるようにという具合だと思います。ログとか大量に扱う場合にまぁ、ほしいですよね。今回はEsのリリースがメインで、今後はKibanaなどとの連携だったり色々改善していくよという話みたいです(<a href="https://www.elastic.co/blog/kibana-7-7-0-released">Kibanaの一部の機能は利用しているみたい</a>)。</p>
<h4 id="ライセンスとサブスクリプションのレベルhttpswwwelasticcojpsubscriptions">ライセンスと<a href="https://www.elastic.co/jp/subscriptions">サブスクリプションのレベル</a></h4>
<ul>
<li>Elastic License</li>
<li>Basic</li>
</ul>
<h4 id="気になるところと予想とか">気になるところ(と、予想とか)</h4>
<ul>
<li>仕組みがどうなっているか?
<ul>
<li>Search APIと同等のリクエストパラメータが使える。が、<a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.7/async-search.html">いくつか制約はありそう</a></li>
<li>おそらくTask Manageerで検索してる処理が管理され、レスポンスにはIDが発行されて、そのIDで処理の進み具合を取得する感じ。</li>
</ul>
</li>
<li>Shard単位?Segment単位?
<ul>
<li>内部的にはShard単位で検索処理を扱ってるので、Shard単位がとりあえず楽そう?</li>
</ul>
</li>
<li>Aggsとかも?
<ul>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.7/async-search.html#get-async-search">対象の模様</a></li>
</ul>
</li>
<li>Sortは?
<ul>
<li>有効。ソートのフィールドがインデックス対象だった場合は、そのデータの統計値を使ってShardをソートするっぽい(<a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.7/async-search.html#submit-async-search">公式リファレンスのNOTE参照</a>)</li>
</ul>
</li>
</ul>
<h4 id="関連しそうなgithubのissuesとか">関連しそうなGitHubのIssuesとか</h4>
<p>まだ読んでない</p>
<ul>
<li><a href="https://github.com/elastic/elasticsearch/issues/49091">Async search · Issue #49091 · elastic/elasticsearch</a></li>
<li><a href="https://github.com/elastic/elasticsearch/pull/49471">Add a listener to track the progress of a search request locally by jimczi · Pull Request #49471 · elastic/elasticsearch</a></li>
<li><a href="https://github.com/elastic/elasticsearch/pull/49092">Pre-sort shards based on the max/min value of the primary sort field by jimczi · Pull Request #49092 · elastic/elasticsearch</a></li>
<li><a href="https://github.com/elastic/elasticsearch/issues/55464">Async search： store intermediate results · Issue #55464 · elastic/elasticsearch</a></li>
</ul>
<h3 id="reduced-consumption-of-heap---elasticsearch">Reduced consumption of heap - Elasticsearch</h3>
<p><a href="https://www.elastic.co/blog/significantly-decrease-your-elasticsearch-heap-memory-usage">ヒープの使用量が7.7で減ってるよというブログ</a>も別途ありました。</p>
<p>元になっているLuceneの実装に関するIssueが「<a href="https://issues.apache.org/jira/browse/LUCENE-8635">［LUCENE-8635］ Lazy loading Lucene FST offheap using mmap - ASF JIRA</a>」です。ヒープ上に展開していたデータをmmapで扱えるようにすることで、ヒープのメモリを削減してる。</p>
<p>で関連して、これがLuceneで操作できるようになって(「<a href="https://github.com/elastic/elasticsearch/pull/42838">Use reader attributes to control term dict memory useage by s1monw · Pull Request #42838 · elastic/elasticsearch</a>」)、そこからEsに取り込まれたと。</p>
<p><code>_id</code>をoff-heapにする話は[ここ](<a href="https://github.com/elastic/elasticsearch/pull/52405">Move the terms index of <code>_id</code> off-heap. by jpountz · Pull Request #52405 · elastic/elasticsearch</a>)にあった。</p>
<p>これに関連して、ヒープサイズの推奨について再考が必要かも?というIssue(<a href="https://github.com/elastic/elasticsearch/issues/52561">Reconsider our recommendations for heap size? · Issue #52561 · elastic/elasticsearch</a>)も上がってる。</p>
<h3 id="painless-lab---kibana">Painless Lab - Kibana</h3>
<p>ほんとにPain<code>less</code>?と言う話はさておき、<a href="https://www.elastic.co/guide/en/elasticsearch/painless/current/painless-execute-api.html">_script APIでexecute</a>はできていましたが、やはりもう少し楽に実行したいですよね?ということで画面ができたみたいです。</p>
<p>シンタックスハイライトとかもできるので、より簡単に使えるようになってますね。
まだ、ベータなので足りないContextとかもあるっぽいけど。</p>
<h4 id="ライセンスとサブスクリプションのレベルhttpswwwelasticcojpsubscriptions-1">ライセンスと<a href="https://www.elastic.co/jp/subscriptions">サブスクリプションのレベル</a></h4>
<ul>
<li>Elastic License</li>
<li>Basic?</li>
</ul>
<p>まだベータだからか、サブスクリプションのページにはなかった。
<a href="https://www.elastic.co/guide/en/kibana/7.7/painlesslab.html">公式ドキュメント</a>と<a href="https://github.com/elastic/kibana/tree/master/x-pack/plugins/painless_lab">GitHubのリポジトリ</a>から、Elastic Licenseであることは判明。</p>
<h4 id="気になるところと予想とか-1">気になるところ(と、予想とか?)</h4>
<ul>
<li>制限事項がどんなものか?
<ul>
<li>使えるContextがまだ少ない?まだGAではない</li>
</ul>
</li>
<li>サジェストがどのくらい効くのか?
<ul>
<li>シンタックスハイライトはあるけど。<a href="https://github.com/elastic/kibana/issues/59962">まだかなぁ?</a></li>
</ul>
</li>
</ul>
<h3 id="その他elasticsearch関連">その他Elasticsearch関連</h3>
<p>7.7リリースのハイライトが別途用意されています。</p>
<ul>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.7/release-highlights-7.7.0.html">7.7.0 release highlights | Elasticsearch Reference ［7.7］ | Elastic</a></li>
</ul>
<p>こっちで気になるのは、ClassificationとかTransformsあたりかなぁ。ML関連の機能で。</p>
<h3 id="workplace-search-ga">Workplace Search GA</h3>
<p>これは別のブログに書くかな。</p>
<h4 id="気になるところ">気になるところ</h4>
<ul>
<li>Betaと何が変わったのか?</li>
<li>APIとかどういう形で提供されるのか?そもそも提供されるのか?</li>
</ul>
<p>どんな機能?みたいなのも書く予定です。</p>
<h3 id="data-visualizerでfilebeatのconfigをサジェスト---kibana-and-filebeat">Data VisualizerでFilebeatのConfigをサジェスト - Kibana and Filebeat</h3>
<p>Kibanaの画面からデータをちょっと?(100MB)だけアップロードして、Elasticsearchにサクッとデータ登録できる機能が実はあります。この機能の拡張として、<a href="https://www.elastic.co/guide/en/kibana/7.7/release-highlights-7.7.0.html#file-uploader-highlights">Filebeatの設定だとこんな感じに作れるよ?というのを提示してくれる</a>ようになったみたいです。
手元にあるファイルを定期的に読み込むときに、設定を書く下地ができるのは便利じゃないかな?</p>
<h4 id="ライセンスとサブスクリプションのレベルhttpswwwelasticcojpsubscriptions-2">ライセンスと<a href="https://www.elastic.co/jp/subscriptions">サブスクリプションのレベル</a></h4>
<ul>
<li>Elastic License</li>
<li>Basic</li>
</ul>
<p><a href="https://www.elastic.co/jp/blog/importing-csv-and-log-data-into-elasticsearch-with-file-data-visualizer">Data Visualizerってどんなもの?というのはここにブログ</a>があります。残念ながらKibanaとかの公式リファレンスには使い方のページがないんだよなぁ。</p>
<h3 id="apmのサービスマップ---apm-and-kibana">APMのサービスマップ - APM and Kibana</h3>
<p>アプリケーションアーキテクチャのどこでAPMが動作しているか、どこと通信しているかという、APMのエージェントが入っているアプリ間のつながりをKibana上で可視化できる機能っぽいです。まだ、ベータみたいですが、面白そう。<a href="https://docs.microsoft.com/ja-jp/azure/azure-monitor/app/app-map?tabs=net">Azure Application Insightのアプリケーションマップ</a>に似てる気がします。</p>
<h4 id="ライセンスとサブスクリプションのレベルhttpswwwelasticcojpsubscriptions-3">ライセンスと<a href="https://www.elastic.co/jp/subscriptions">サブスクリプションのレベル</a></h4>
<ul>
<li>Elastic License</li>
<li>Platinum</li>
</ul>
<h4 id="気になるところ-1">気になるところ</h4>
<ul>
<li>どうやって作ってる(つながりをどうやて判断してる)のか?
<ul>
<li>分散トレーシングのデータを元に誰がどこと通信してるってのは取れるんじゃなかろうか?</li>
</ul>
</li>
</ul>
<h3 id="log-categorization-and-contextual-examples---kibana-and-elasticsearch">Log categorization and contextual examples - Kibana and Elasticsearch</h3>
<p>7.6から入ってたっぽいですが、<a href="https://www.elastic.co/blog/elastic-logs-7-6-0-released">ログの分類</a>をMLの機能を使ってできるものが、LogsのUIとかでさらに使いやすくなった模様。</p>
<h4 id="ライセンスとサブスクリプションのレベルhttpswwwelasticcojpsubscriptions-4">ライセンスと<a href="https://www.elastic.co/jp/subscriptions">サブスクリプションのレベル</a></h4>
<ul>
<li>Elastic License</li>
<li>Platinum</li>
</ul>
<h4 id="気になるところ-2">気になるところ</h4>
<ul>
<li>7.6の機能から追いかけないとなぁ。。。
<ul>
<li>似たようなログをカテゴリーごとに分析できるようになるので、プラスMLの仕組みでこれまでとは異なる種類のログが出始めたみたいなことが分析できそう。</li>
</ul>
</li>
</ul>
<h2 id="まとめ">まとめ</h2>
<p>眺めるだけで時間かかりましたが、まぁ、相変わらずいっぱいありますね。
興味のあるところの濃淡が出た感じになりましたが、気になる点をピックアップしてみました。
おかしなところとか、ここはどういう意味?などあればツッコミお願いします。</p>
</content:encoded>
    </item>
    
  </channel>
</rss>
