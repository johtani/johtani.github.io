<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>検索システム探訪 on @johtaniの日記 3rd</title>
    <link>https://blog.johtani.info/tags/%E6%A4%9C%E7%B4%A2%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E6%8E%A2%E8%A8%AA/</link>
    <description>Recent content in 検索システム探訪 on @johtaniの日記 3rd</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja</language>
    <lastBuildDate>Mon, 10 Feb 2020 23:20:27 +0900</lastBuildDate><atom:link href="https://blog.johtani.info/tags/%E6%A4%9C%E7%B4%A2%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E6%8E%A2%E8%A8%AA/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>「検索システム探訪」したいな=&gt;やりました</title>
      <link>https://blog.johtani.info/blog/2020/02/10/explore-search-system/</link>
      <pubDate>Mon, 10 Feb 2020 23:20:27 +0900</pubDate>
      
      <guid>https://blog.johtani.info/blog/2020/02/10/explore-search-system/</guid>
      <description>また、ツイートから始まるお話です。 まだまだ、検索システムってどんなものかを勉強したいしということで、こんなのをツイートしてました。 「検索シス</description>
      <content:encoded><p>また、ツイートから始まるお話です。
まだまだ、検索システムってどんなものかを勉強したいしということで、こんなのをツイートしてました。</p>
<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">「検索システム探訪」みたいな名前がいいかな? <a href="https://t.co/sG7BDdGI9h">https://t.co/sG7BDdGI9h</a></p>&mdash; Jun Ohtani (@johtani) <a href="https://twitter.com/johtani/status/1225306152721739776?ref_src=twsrc%5Etfw">February 6, 2020</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>検索について知り合いとお茶をしながら話をしていて、こういう話を聞くの面白いなぁと思ったので。
どんなことを個人的には聞きたいかな?というのをまとめといたほうがいいかと思いブログを書いています。
こんなことも面白そうだよね?</p>
<h2 id="どんなこと聞きたいかな">どんなこと聞きたいかな?</h2>
<p>いまのところ思いついた内容はこんな感じかな?
こんなのも聞くと面白そうだよね?などありましたら、コメント欄に書いてもらえればと。</p>
<ul>
<li>利用しているシステム・サービスは?
<ul>
<li>構成やどこのサービスなのか？</li>
</ul>
</li>
<li>検索ユーザーはどんな人？
<ul>
<li>ユーザーの種類</li>
<li>ユーザーの検索ニーズ</li>
</ul>
</li>
<li>検索対象データはどんなもの？
<ul>
<li>データ件数はどのくらい？</li>
<li>属性、項目がどのくらいあるか？</li>
</ul>
</li>
<li>検索結果として出したいものは？
<ul>
<li>ソートはどんなものがあるの？</li>
<li>ランキングで重要なものは？</li>
</ul>
</li>
<li>UI/UXはどんな感じ?
<ul>
<li>ハイライト、ソート、ファセット(Aggs)</li>
<li>キーワードサジェスト、オートコンプリート</li>
</ul>
</li>
<li>検索システムの監視(オブザバビリティ??)
<ul>
<li>ビジネス的な指標</li>
<li>クエリログ、クリック(ユーザーに関する情報)</li>
<li>システムメトリクス</li>
</ul>
</li>
<li>困っていることは？
<ul>
<li>ランキング</li>
<li>クエリ</li>
<li>検索システム分析</li>
</ul>
</li>
</ul>
<h2 id="第1回やりました">第1回やりました。</h2>
<p>ちなみに、最初のツイートに対して、すぐに返事をくれた方がいました。</p>
<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">うちでよければご説明します！</p>&mdash; Kizashi （令和もRailsエンジニア募集中） (@kizashi1122) <a href="https://twitter.com/kizashi1122/status/1225293097329819648?ref_src=twsrc%5Etfw">February 6, 2020</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>Twitter本当にありがとうございますという感じです。</p>
<p>で、早速話を聞かせていただきました。大阪の方だったので、テレカンでやらせていただきました。
移動時間とか気にせずにできるので、テレカン形式いいですよね。</p>
<p>内容は、非常に面白かったです。
使ってるシステムについて、どんなところで、どのようなように検索エンジンをつかっているのか、
どんなことで困っているのかなどをお聞きすることができました。</p>
<h3 id="20200213-追記">2020/02/13 追記</h3>
<p>対応していただいた<a href="https://ingage.co.jp/">Ingage</a>の永田さんから、内容を公開しても良いという承諾をいただいたので、メモを公開します。</p>
<ul>
<li>サービス : <a href="https://ingage.jp/relation/">Re:lation</a>
<ul>
<li>問い合わせメールなどのチームで対応する対応</li>
</ul>
</li>
<li>利用している検索エンジン
<ul>
<li>Elasticsearch (AWS Es)
<ul>
<li>ノード数 8 - 3 master + 5 data</li>
</ul>
</li>
</ul>
</li>
<li>データ
<ul>
<li>データ数 : 約1億5千万</li>
<li>親子関係 : チケット - メール(=1ドキュメント) - コメント
<ul>
<li>画面としてはチケットの一覧=aggsでチケットIDの一覧を生成してリスト表示</li>
</ul>
</li>
<li>インデックス数 : 5 = テナントごとに振り分けしてる。
<ul>
<li>8シャード - スケールアウトした場合も対応できるので。</li>
</ul>
</li>
<li>PostgreSQLにマスターは保存</li>
<li>データの単位はメール。コメントはtextの配列でメールに保存されている。</li>
<li>EsはIDの一覧を返す。ただし、<em>チケットのIDの一覧</em></li>
</ul>
</li>
<li>機能
<ul>
<li>ハイライト
<ul>
<li>Esではなく独自実装。</li>
</ul>
</li>
<li>クエリ
<ul>
<li>n-gramでやってる = kuromoji使ってない</li>
<li>min=1, max=2</li>
</ul>
</li>
</ul>
</li>
<li>悩み事
<ul>
<li>EBS上だったものをローカルにしたので速くなった。</li>
<li>期間が長いと、検索結果一覧の表示が遅い
<ul>
<li>aggsが遅いのかな?</li>
<li>検索結果一覧はチケットが持っているメールの日付の降順。結果一覧はチケットの一覧。</li>
</ul>
</li>
<li>詳細検索はDB、左のステータスもファセットも現在はDBから生成
<ul>
<li>Es使ったほうが早いかも?</li>
</ul>
</li>
<li>マルチテナントのつらさ</li>
<li>検索ログ
<ul>
<li>独自ログはとっていない = アプリのログから判別</li>
</ul>
</li>
</ul>
</li>
<li>今後
<ul>
<li>アドレス帳検索</li>
</ul>
</li>
</ul>
<h2 id="お誘いお待ちしております">お誘いお待ちしております!</h2>
<p>今後もこれやっていきたいなぁ。話してもいいよ!という方がいらっしゃいましたら、<a href="https://twitter.com/johtani">@johtani</a>までDMもしくはメンションをください。お待ちしております!</p>
</content:encoded>
    </item>
    
  </channel>
</rss>
