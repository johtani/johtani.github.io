<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: aws | @johtaniの日記 2nd]]></title>
  <link href="http://blog.johtani.info/blog/categories/aws/atom.xml" rel="self"/>
  <link href="http://blog.johtani.info/"/>
  <updated>2015-04-01T17:54:29+09:00</updated>
  <id>http://blog.johtani.info/</id>
  <author>
    <name><![CDATA[johtani]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[「よくわかるAmazon #CloudSearch 」に行ってきました！]]></title>
    <link href="http://blog.johtani.info/blog/2014/05/15/amazon-cloud-seaarch-study-session/"/>
    <updated>2014-05-15T17:50:00+09:00</updated>
    <id>http://blog.johtani.info/blog/2014/05/15/amazon-cloud-seaarch-study-session</id>
    <content type="html"><![CDATA[<p>どうやら、中身がSolrベース？Luceneベース？になったらしいということで、
今日は<a href="http://kokucheese.com/event/index/168838/">「AWSプロダクトシリーズ｜よくわかるAmazon CloudSearch」</a>に行ってきました。</p>

<p><strong>※ElasticSearchではありません！</strong></p>

<!-- more -->


<p>ということで、いつものメモ。</p>

<h2>CloudSearch Overview</h2>

<h3>Amazon Web Services, Inc. Pravin Muthukumar(Product Manager) / Vivek Sriram (Business Development)</h3>

<h4>Introduction to Search</h4>

<ul>
<li>検索の紹介。アイアンマンのDVD？のページにいろんな項目（フィールド）があるよねと。（もちろん、Amazonのページ）</li>
<li>ファセット、Geo、テキスト処理（Analysis処理）、Postings listとか。とかとか</li>
<li>ランキングも</li>
</ul>


<h4>Amazon CloudSearch</h4>

<ul>
<li>独自実装orRDB拡張もある。</li>
<li>OSSもあるよね。</li>
<li><strong>Legacy</strong> Enterprise SearchとしてFASTとかもある。</li>
</ul>


<h4>Building with CloudSearch</h4>

<ul>
<li>他のサービス同様、コンソールとかあるし、色々できるし、すぐ起動できるよと。</li>
</ul>


<p>自動で、データが増えたら、パーティションが増えると。</p>

<ul>
<li>日本語の形態素解析があるらしい。何を使ってるのかな？</li>
<li>ICUのノーマライズとかもやってくれるらしい。これかな？<a href="http://lucene.apache.org/core/4_8_0/analyzers-icu/index.html">http://lucene.apache.org/core/4_8_0/analyzers-icu/index.html</a></li>
<li>ユーザが辞書を指定できるのかな？</li>
</ul>


<p>備えてる機能の説明</p>

<ul>
<li>ファセット</li>
<li>SimpleQuery</li>
<li>Autocomplete</li>
<li>Highlight</li>
</ul>


<p>などなど</p>

<ul>
<li>Multi-AZにも対応</li>
</ul>


<h4>QA</h4>

<ul>
<li>Q：NGramありますか？

<ul>
<li>A：今はないです。</li>
</ul>
</li>
<li>Q：ユーザ辞書対応してますか？

<ul>
<li>A：今はないです。</li>
</ul>
</li>
<li>Q：lang-detectあるか？

<ul>
<li>A：今はないので、自分で判定して、適切なフィールドに入れてね。</li>
</ul>
</li>
</ul>


<h2>Expectation for CloudSearch</h2>

<h3>Apache Solr contributor　大須賀　稔氏</h3>

<ul>
<li>Solr本の宣伝ありがとうございます！（右のアイコンから買ってもらえると更に嬉しいですｗ）</li>
<li>Kinesisとかとの組み合わせとか、自然言語処理とか、いろいろとあるAWSのコンポーネントと組み合わせる例が欲しいと。</li>
<li>すばらしい、最後はManifoldCFがらみに持っていくとは。ACLがらみのクローリングとかあるといいじゃないでしょうかと。</li>
</ul>


<h2>Impression of using CloudSearch</h2>

<h3>吉田　匠氏　(@yoshi0309　<a href="http://blog.yoslab.com/">http://blog.yoslab.com/</a>)</h3>

<p>スライド：<a href="https://speakerdeck.com/yoshi0309/impression-of-using-cloudsearch">https://speakerdeck.com/yoshi0309/impression-of-using-cloudsearch</a></p>

<ul>
<li>お見かけしたことある気がするなぁ。</li>
<li>全部置き換えできる！わけではなさそう。。。</li>
</ul>


<h4>いいところ。</h4>

<ul>
<li>UIがいいし、セットアップが簡単</li>
<li>auto scaleがうれしい</li>
<li>マルチドメイン、マルチスキーマがいい</li>
<li>Luceneのdismaxサポートがいい。（edismaxじゃないのかな？）</li>
</ul>


<p>dismaxって書いてあるな。</p>

<p><a href="http://docs.aws.amazon.com/cloudsearch/latest/developerguide/search-api.html">http://docs.aws.amazon.com/cloudsearch/latest/developerguide/search-api.html</a></p>

<ul>
<li><p>フィードの仕方に気をつけて！</p>

<ul>
<li>バッチサイズで課金されるので、1件ずつじゃなくて、複数件送ったほうがいい。</li>
</ul>
</li>
<li><p>いきなりスケールアウトできるわけじゃない？</p></li>
<li><p>ウォームアップ機能がない。インスタンス上限がデフォルト50件</p></li>
<li><p>VPC対応してほしい。</p>

<ul>
<li>インターネット経由になってしまう</li>
<li>フィードのスピードが</li>
<li>セキュリティグループ機能が使えない</li>
</ul>
</li>
</ul>


<h2>CloudSearch UseCase - SnapDish</h2>

<h3>Vuzz Inc.　清田　史和氏</h3>

<ul>
<li>独自辞書をもって、Tokenizeは独自でやって、空白区切りでデータ登録している。</li>
<li>インデックス更新はSQSを使ってる。</li>
<li>古いAPIを使ってるらしい。</li>
<li>移行が結構大変らしい。</li>
</ul>


<h2>感想</h2>

<p>使ったことないんですが、きめ細かい検索したい場合はちょっとテクニックが要るかもと思いました。
AWS初心者なんで、なんとも言えないんですが。。。</p>

<p>といあえず、テキスト処理（アナライズ処理）で、単語がどうやって区切られるのかってのがわからないのはキツイんじゃなかろうかと。
ただ、簡単に起動できて、オートスケールできるのは素晴らしいと思います。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[AWS Summit Tokyo 2013に行って来ました。(Day2) #awssummit]]></title>
    <link href="http://blog.johtani.info/blog/2013/06/06/aws-summit-tokyo-day2/"/>
    <updated>2013-06-06T23:00:00+09:00</updated>
    <id>http://blog.johtani.info/blog/2013/06/06/aws-summit-tokyo-day2</id>
    <content type="html"><![CDATA[<p>昨日に引き続き、AWS Summit Tokyo 2013に行ってきました。</p>

<p>@ryu_kobayashiさんからパシリを仰せつかるなどあり、忙しかったのですが楽しかったです。</p>

<p>今日もすごい人出で、昼時の展示ブースは人だかりで、TDの方たち忙しそうでした。
後半はちょっとつかれたなぁ。
1日目よりも空調の温度が上がってたので快適でした。
飲物忘れたので、ちょっと喉がやられ気味でしたが。</p>

<p>AWSはやっぱり勢いがあるんだなぁってのを実感しました。JAWS-UGまで残った感想です。
あとは、セルフハンズオンに参加するんだったかなぁというのもちょっとあります。あんまり触ったことないんで。</p>

<p>以下はいつものメモです。</p>

<!-- more -->


<h2>Amazon Redshiftが切り開くクラウド・データウェアハウス</h2>

<h4>自己紹介と流れとニュース</h4>

<ul>
<li>6/5からTokyoリージョンでも利用可能に！</li>
</ul>


<h4>Redshiftどんなもの？</h4>

<ul>
<li>Redshift＝クラウド型データウェアハウス</li>
<li>オンプレの課題

<ul>
<li>初期投資、運用管理、費用対効果</li>
</ul>
</li>
<li>EMRと同じで、分析処理向けのサービス</li>
<li>簡単な利用例

<ul>
<li>各種データストア→S3→Redshift</li>
<li>各種データストア→EMR→Redshift</li>
<li>Data Pipelineでデータの流れの処理がかける。</li>
</ul>
</li>
<li>データロードはパラレルに実行可能</li>
<li>バックアップは管理コンソールからボタンででも可能。</li>
<li>クラスタのリサイズも管理コンソールからできるよ。</li>
</ul>


<h4>NRIでの評価</h4>

<ul>
<li>2012年末の限定公開してすぐに先行評価に参加</li>
<li>Redshiftの性能は？

<ul>
<li>500億件からの検索処理（1週間分のデータを抜き出して処理するSQL）

<ul>
<li>8XLノード2ノードで43秒、4ノードで27.8秒、8ノードで19秒</li>
<li>データロドも線形に性能が上がる</li>
</ul>
</li>
<li>1.2億件の検索処理は4ノードより8ノードのほうが性能劣化</li>
<li>EMRとRedshiftの比較。1.5TB、500億件でのJOIN＋集計処理でRedshiftのほうが早かった。</li>
</ul>
</li>
<li><p>Redshiftのチューニングポイント</p>

<ul>
<li>インデックスが存在得ず、Distribution Keyでノードに分散</li>
<li>Sort Keyも重要。データロード時間はSort Keyをつけると遅くなる</li>
</ul>
</li>
<li><p>ニガテなデータ形式もあるよ。EMRとかの組み合わせにすると安く済むこともあるよ</p></li>
<li>簡単につくれるので、気をつけましょう。セキュリティとか。統制されないものが乱立してくるんで。

<ul>
<li>そこでNRIですよ！（宣伝）</li>
</ul>
</li>
</ul>


<p>出てきた性能に関するものだけど、「ケース１」「ケース２」とかってなってるので、その部分の詳細が書かれたレポートが公開されないとどんなのがニガテなのかとかわからなかった。</p>

<h4>事例紹介とか</h4>

<ul>
<li>オンプレのデータをどうやってRedshiftに持ってくの？

<ul>
<li>インフォテリアのASTERIA WARP

<ul>
<li>GUIツールでデータの変換とかして、S3に持って行って、Redshiftと連携できるよと。</li>
</ul>
</li>
</ul>
</li>
</ul>


<h4>無料セミナーの紹介</h4>

<ul>
<li>6/21、8/2にRedshiftの無料セミナーやりますよ。</li>
</ul>


<h2>インターネット上のユーザーの行動の可視化を実現したAWSによるビックデータ解析基盤</h2>

<h4>C-Finderのサービス紹介</h4>

<p>元オプトの方。C-Finderの紹介。
10万ユーザの行動履歴の可視化。</p>

<p>サイトに来たけど、行動せずに他サイトに移動したとか、サイトに来る前の状態ってのがわからない。これをC-Finderで可視化。</p>

<ul>
<li>例１：自動車業界

<ul>
<li>ライバル企業の動向を自社と比較したい。</li>
<li>Audi、BMW、ベンツで可視化。</li>
</ul>
</li>
<li>例２：化粧品業界

<ul>
<li>Web上での化粧品のトレンドが見たい。</li>
<li>@cosmeサイトのPVとかから。</li>
</ul>
</li>
</ul>


<p>ユーザって会員登録とかしてる人を追っかけてるってことなのかなぁ？
よくわかってない。。。</p>

<ul>
<li>レポーティングサービスしてたけど、納品まで１ヶ月かかってた。</li>
<li>リアルタイムにみたいという要望が多かったのでASPをTISと開発</li>
</ul>


<h4>ASPサービスの開発したよ</h4>

<ul>
<li>AWSで。</li>
</ul>


<p>可視化というタイトルだったんだけど、期待してた可視化の話ではなかった。。。</p>

<h2>ネット選挙クラウド　～オバマ大統領選挙の事例：データ解析からネット募金まで～</h2>

<ul>
<li>ボランティアで構成ってすごいな。</li>
<li>本番まで１年</li>
<li>みんな髭の人だｗ</li>
<li>GoogleとかFacebookとかの人がボランティアで開発に参加。</li>
<li>予算は抑えながら、スケールアップダウンがすぐ出来てとか。</li>
<li>秒間10万回のI/OのDB</li>
<li>SQSとEC2のSoftware queueの比較。Softwareキュー選ぶと、さらにドレがいいのかってのを選ばないとい。</li>
<li>AWSにあるサービスなら、造らなくてもいいのではとか。

<ul>
<li>CloudSearchはつかわなかったのかなぁ？</li>
</ul>
</li>
<li>tsunami</li>
<li>S3に静的ページをおいて、最後のとりでにしたり。</li>
<li>コードとか、ノウハウってどこまで公開されてるんだろ？</li>
</ul>


<p>同時通訳もあったんですが、英語を聞いてみようと聞いてましたが、まだまだダメですねぇ。</p>

<h2>パネルディスカッション「ウェブテクノロジーをエンタープライズで活かすには？」</h2>

<h4>趣旨</h4>

<ul>
<li>B2B、B2C間でのトレンドのやり取りが加速されてるよねと。</li>
<li>ICTはもはやコモディティ？</li>
</ul>


<h4>TD太田さん</h4>

<ul>
<li>Consumerization Of IT</li>
<li>色々なものがSaaSになってきてる</li>
<li>TD：Consumerization of Data Infrastructure

<ul>
<li>オンプレ＜AWS＜TD</li>
</ul>
</li>
</ul>


<h4>三井物産黒田さん</h4>

<ul>
<li>三井クラウド（プライベート＆パブリック）</li>
<li>ユビキタス</li>
<li>これまで使ってきたものがクラウドで動くのかとかが観点</li>
</ul>


<h4>電通平川さん</h4>

<ul>
<li>マーケティングダッシュボードはsalesforceでは厳しかった？</li>
<li>ビジネスに注力したいので、柔軟で、質実剛健なICT基盤がほしい。</li>
</ul>


<h4>ディスカッション</h4>

<ul>
<li><p>新しい技術に対するスタンスは？</p>

<ul>
<li>いかにダメな部分を潰していくか（太田さん）</li>
<li>R&amp;Dを予算化して評価して取り組んでいく。評価でダメならつぎ。（黒田さん）</li>
<li>消費者の方たちがネットですごい勢いで活動してる。その人達へのアプローチが重要。（平川さん）</li>
</ul>
</li>
<li><p>コンシューマ系技術の懸念事項は？</p>

<ul>
<li>セキュリティ面。レベルがある。自分の所だけじゃなく、クラウドベンダーと二人三脚が必要。丸投げはNG（黒田さん）</li>
<li>セキュリティ面の攻撃を受けたつぎの手をどう打つかが重要。堅牢性上げると、ユーザビリティが下がる。（平川さん）</li>
<li>法規制的に出せないとかもある。持ちきれないデータもあるよね。（太田さん）</li>
</ul>
</li>
<li><p>何を見分けてどうやって取り組むか？</p>

<ul>
<li>とりあえず、やってみる。そこで見える課題に対応していく。見極めるのは難しい（平川さん）</li>
</ul>
</li>
<li>ということは、すぐに出来る環境ってのは当たり前になってますよね。</li>
</ul>


<p>尖った技術＝セキュリティ面が弱い？みたいな印象があるのかなぁ？</p>

<h2>JAWS-UG</h2>

<h4>AWSアップデート</h4>

<ul>
<li>AmazonのCTO登場</li>
</ul>


<h4>Game Day</h4>

<ul>
<li>Game Day。土曜日にやるよ。</li>
<li>障害を発生させて、それを復旧させる。</li>
<li>最もひどい壊し方をしたらかちｗ</li>
</ul>


<p>最後はかるくボッチでした。。。
AWSあんまり使ってないからなぁ。。。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[AWS Summit Tokyo 2013に行って来ました。(Day1) #awssummit]]></title>
    <link href="http://blog.johtani.info/blog/2013/06/05/aws-summit-tokyo-day1/"/>
    <updated>2013-06-05T18:30:00+09:00</updated>
    <id>http://blog.johtani.info/blog/2013/06/05/aws-summit-tokyo-day1</id>
    <content type="html"><![CDATA[<p><a href="http://www.awssummittokyo.com/timetable.html">AWS Summit Tokyo 2013</a>に行って来ました。</p>

<p>@cocoatomoさんに行き掛けに出会ったので、アンデルセンの講演を一緒に聞いてました。
TDブースの@ryu_kobayashiさんに挨拶に伺ったりも。</p>

<p>すごい人で、セッション間の入れ替え時には会場前のスペースが大変なことになってました。もう少し余裕のある建物のほうが良かったのかもしれないですねぇ。</p>

<p>いつものように以下はメモです。</p>

<!--  more -->


<h2>Road to AWS アンデルセンサービス</h2>

<p>とてもおいしいランチボックスでした。</p>

<p><img src="/images/entries/20130605/lunch1.jpg" width="300" title="ランチボックスとパンフレット" >
<img src="/images/entries/20130605/lunch2.jpg" width="300" title="ランチボックス中身" ></p>

<p>広島（ここ重要！）に本社のあるパン屋さん。</p>

<ul>
<li>2003年に汎用機からOpenシステムに

<ul>
<li>内製ではなく外注に。複数のSIerにお願いしてるとデータセンタに</li>
<li>マスタ管理と生産管理はオンプレ</li>
<li>2004年に稼動時のネットワーク整備。店舗はISDNで、設定ミスとかを防ぐためにIIJのSMFサービスに</li>
</ul>
</li>
<li>PCはレンタル契約にしたので入れ替えを強制できる→レガシーシステムの対応が必要なくなる

<ul>
<li>ネットワーク広帯域化→基本システムにデータセンターに。</li>
<li>2009年にリース満了などで、OSの変更とかミドルの変更という移行SI費用だけで結構な値段が。ものによっては会社もない。</li>
<li>データセンターの月額手数料にして、機器変更などの費用を平準化。仮想化など。</li>
<li>けど、サイジングにどうしても安全係数をかけてしまうことに。結構値段がかかる</li>
</ul>
</li>
<li>そこで、今後の方向性

<ol>
<li> SIerどっぷりのOLTP受発注基幹システムはSIerのホスティングで</li>
<li> それ以外のシステムは外に出したい</li>
</ol>
</li>
<li>バッチの計算を早くすることができるとノーチラスさんから提案された

<ul>
<li>バッチを外部化するか、性能あげるか。IOネックなどもありスペック上げるとコストになるから、外部化したい</li>
<li>Hadoopを組むけど、オンプレじゃなくてAWSにした。ノウハウがないので、ノーチラスさんにお任せした。</li>
<li>AWSのEMRを利用。4時間かかっていたものが40分で。</li>
<li>EDIのサーバを6ヶ月でAWSに移行</li>
</ul>
</li>
<li>S3絡みで2度の問題が。性能劣化があった。</li>
<li>パッケージ開発環境がAWSにあるなら、AWSでも動くでしょ？（NTTイントラマートとか）</li>
<li><p>SIerどっぷりの部分もAWSに持っていく？</p>

<h3>アンデルセンサービスの部長さんからのAWSへの要望</h3></li>
<li><p>メールサーバなどの基本サビスとか、コントロールパネルを充実して欲しい。</p></li>
</ul>


<h2>クラウド技術を活用したリアルタイム広告&#8221;Logicad&#8221;の入札・配信・ログ解析</h2>

<h4>Web広告の歴史</h4>

<ol>
<li>最初は広告主がWebサイト単位で契約</li>
<li>アドネットワークによる仲介</li>
<li>聞きそびれた。。。DSP？</li>
<li>アドネッエクスチェンジ</li>
<li>SSP(Supply Side Platform)</li>
</ol>


<h4>リアルタイムビッティング（RTB）</h4>

<p>RTPの仕組みを説明。
AWSとオンプレでシステムを構築してる。</p>

<ul>
<li>SSP事業者との取引はオンプレ</li>
<li>配信はAWS</li>
<li>オンプレとAWSはAWS Direct Conectで接続

<ul>
<li>S3とHadoopの接続が安くなったり速くなったりするらしい。</li>
</ul>
</li>
</ul>


<h5>オンプレミス側</h5>

<ul>
<li>Bidリクエスト：秒間数万件。。。</li>
<li>KVSのユーザ数は３億件。。。</li>
<li>AEROSPIKEというSSD向けのKVSを利用してる</li>
</ul>


<h5>AWS側</h5>

<ul>
<li>ログはS3に。溜まったデータは定期的にEMRで解析。DynamoDBに入れてレポート作成</li>
<li>RabbitMQを使ってる。</li>
<li>ELBで外部からのリクエストはバランシング</li>
</ul>


<h5>データセンタ間通信</h5>

<ul>
<li>遅延を複数コネクションを貼る方法で回避？</li>
<li>非同期で、複数のMsgとAckをやり取りする。RabbitMQがこれに相当する機能を持ってる

<ul>
<li>QueueとConsumerで多重送信が可能。</li>
<li>配信結果をオンプレ側に送るのにRabbitMQを使ってるのかな？</li>
</ul>
</li>
</ul>


<h2>ハイブリッド構成を支えるAWSテクノロジー</h2>

<p>聞くつもりだったんだけど、すごい人だったので、諦めて充電してた。</p>

<h2>AWSクラウドで構築する、ワールドクラスの分散クラウドアーキテクチャ</h2>

<p>エマージングソリューション部の部長のshot6さん。</p>

<h3>マルチAZ（アベイラビリティゾーン）モデル</h3>

<p>AWS固有のコンセプト。
ELBやDynamoDBやRDS、S3とか。</p>

<p>マルチリージョンとは違うよと。マルチリージョンは結構難しいので。
マルチリージョンがどんなに大変かをこれから説明。</p>

<h4>マルチリージョンアーキテクチャ（これは別物）</h4>

<ul>
<li>複数のリージョンを利用して作る。</li>
<li>AWSのビルディングブロックではカバーしない範囲をカバーしないとダメとか。</li>
<li>リージョン間の通信は基本的に非同期</li>
<li>ディザスタリカバリ

<ul>
<li>コストバランス見てから決めるよね。</li>
</ul>
</li>
<li>CAP定理とかもいろいろと出てくるよね。</li>
<li>合意プロトコル。正確性、生存性（時間が制限されても大丈夫）、理論的にパフォーマンス出る？</li>
<li>非同期レプリケーションになる（1トランザクション当たりのオーバヘッドが大きいから）けど、復旧の難しさがある。

<ul>
<li>GlusterFSとかでやってるとこもある。</li>
<li>NetflixはCassandraをクオラム＋Geo-Replicationでマルチリージョンを構成してる。</li>
</ul>
</li>
<li>マルチリージョンでのデータ一貫性は維持がむずい</li>
</ul>


<h5>注意点</h5>

<ul>
<li>必要になるまで分散させない。

<ul>
<li>まずは、マルチAZを考えましょう</li>
</ul>
</li>
<li>物理制限を考慮する

<ul>
<li>同期型だとタイムラグあるし。</li>
</ul>
</li>
<li>複合障害の伝搬をどう抑えるか。

<ul>
<li>NetflixはHYSTRIXというのがいて遮断できるようにしている</li>
</ul>
</li>
<li>自動化が重要。ロールバックとかロールアウトとか。</li>
</ul>


<h5>テストをどーするの？</h5>

<p>本番環境でアクティブ/アクティブ構成でのテスト。
ちゃんとフェイルオーバするかなどを実環境でやってる。DB落としたり。。。
障害は避けられないので、受け入れて日常に取り込むべきだよねと。</p>

<ul>
<li>Amazon.comではGameDay</li>
<li>NetflixはChaos Monkey（OSS）</li>
<li>Obama for America</li>
</ul>


<p>リカバリーオリエンテッドコンピューティングパターン</p>

<ul>
<li>ボーアバグ：再現可能なソフトウェバグ</li>
<li>ハイゼンバグ：通常ではありえないパターンで発生するバグで、調査が大変</li>
</ul>


<h4>ということで、マルチAZがいいよ</h4>

<ul>
<li>同期式レプリケーションを前提にできる。</li>
<li>アプリ開発者がアプリにフォーカスできる。分散系の難しいところはAWSが隠蔽してくれるから。</li>
</ul>

]]></content>
  </entry>
  
</feed>
